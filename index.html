<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gestión de Incidencias Eroski</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
    h1 { text-align: center; }
    .tabs { display: flex; justify-content: center; margin-bottom: 20px; }
    .tab { padding: 10px 20px; cursor: pointer; background: #ddd; margin: 0 2px; border-radius: 5px 5px 0 0; }
    .tab.active { background: #fff; font-weight: bold; border-bottom: 2px solid #fff; }
    .tab-content { display: none; background: #fff; padding: 20px; border-radius: 0 5px 5px 5px; }
    .tab-content.active { display: block; }
    form { display: flex; flex-direction: column; gap: 10px; }
    select, input, textarea { padding: 5px; font-size: 14px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 8px; border: 1px solid #ccc; }
    th { background: #eee; }
    button { padding: 8px 15px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
    button:hover { background: #0056b3; }
</style>
</head>
<body>

<h1>Gestión de Incidencias Eroski</h1>

<div class="tabs">
    <div class="tab active" data-tab="crear">Crear incidencia</div>
    <div class="tab" data-tab="abiertas">Incidencias abiertas</div>
    <div class="tab" data-tab="cerradas">Incidencias cerradas</div>
</div>

<div id="crear" class="tab-content active">
    <form id="incidenciaForm">
        <input type="text" name="referencia" placeholder="Referencia" required>
        
        <select name="centro" required>
            <option value="">Selecciona centro</option>
            <option>Eroski Binissalem I (6705)</option>
            <option>Eroski Binissalen II (6096)</option>
            <option>Eroski NOVA PARIS-CALVIA (7490)</option>
            <option>Eroski Secar (6495)</option>
            <option>Eroski Son Moix (6801)</option>
            <option>Eroski Dragonera (6350)</option>
            <option>Eroski La Puebla (6362)</option>
            <option>La Puebla 2 (6067)</option>
            <option>Eroski Bendinat (6752)</option>
            <option>Eroski Indioteria (6514)</option>
            <option>Eroski Son Cladera (6538)</option>
            <option>Eroski Mercat de Llevant (6729)</option>
            <option>Eroski Portixol (6753)</option>
            <option>Eroski Can Pastilla (6806)</option>
            <option>Eroski Borne (6831)</option>
            <option>Eroski Santa María I (6309)</option>
            <option>Eroski Santa María II (6694)</option>
            <option>Eroski Escorxador (6363)</option>
            <option>Eroski Coll I (6376)</option>
            <option>Eroski Coll II (6718)</option>
            <option>Eroski Palmanova (6537)</option>
            <option>Eroski Santanvi (6713)</option>
            <option>Eroski Colonia (6499)</option>
            <option>Eroski Médico Jose Darder (6749)</option>
            <option>Eroski Consell (6643)</option>
            <option>Eroski Soller II (6692)</option>
            <option>Eroski Capitán Salom (6892)</option>
            <option>Eroski Campos II (6653)</option>
            <option>Eroski Llucmajor (6759)</option>
            <option>Eroski Pascual Ribot (6882)</option>
            <option>Eroski Alaró (6719)</option>
            <option>Eroski Lloseta (6308)</option>
            <option>Eroski Capitán Salom II (7558)</option>
            <option>Eroski Son Rullan (6439)</option>
            <option>Eroski Son Ferriol (6714)</option>
            <option>Eroski Pascual Ribot II (7557)</option>
            <option>Eroski Fábrica (6983)</option>
            <option>Eroski Archiduque (6625)</option>
            <option>Eroski Navegación (7503)</option>
            <option>Eroski Inca (6398)</option>
            <option>Eroski Inca IV NORTE (6066)</option>
            <option>Eroski Andrea Doria (6574)</option>
            <option>Eroski Algaida (6726)</option>
            <option>Eroski Manacor I (6377)</option>
            <option>Eroski Industria (6328)</option>
            <option>Eroski MERCAT NOU (6755)</option>
            <option>Eroski Pérez Galdos (6756)</option>
            <option>Eroski Pere Garau (6793)</option>
            <option>Eroski Muro (6909)</option>
            <option>Eroski INCA-GRAN VÍA COLOM (6895)</option>
            <option>Eroski Reyes Católicos (6360)</option>
            <option>Eroski Sa Cabaneta (6852)</option>
        </select>
        
        <input type="text" name="solicitadoPor" placeholder="Solicitado por" required>
        <textarea name="descripcion" placeholder="Descripción" required></textarea>
        <input type="text" name="materiales" placeholder="Materiales">
        <input type="file" name="foto">
        <button type="submit">Guardar incidencia</button>
    </form>
</div>

<div id="abiertas" class="tab-content">
    <table id="tablaAbiertas">
        <thead>
            <tr>
                <th>Referencia</th>
                <th>Centro</th>
                <th>Descripción</th>
                <th>Fecha apertura</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<div id="cerradas" class="tab-content">
    <table id="tablaCerradas">
        <thead>
            <tr>
                <th>Referencia</th>
                <th>Centro</th>
                <th>Descripción</th>
                <th>Fecha cierre</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQPnuyc6xEROYNoCAmSB_aICRJOE4k2ZCOli8awlPn-Agn-fuACB68kKwGpZTjPMo19jW-SmJPIRfzP/pub?gid=0&single=true&output=csv';
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyof-QWtneajf72yU
